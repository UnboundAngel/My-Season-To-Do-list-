:root{
  --bg:#090910;
  --ink:#e7e9f7;
  --muted:#a5aec7;
  --panel:#10121a;
  --edge:#1d1f2a;
  --blood:#d21e3c;
  --blood2:#7e0b22;
  --blood3:#ff6b88;
  --good:#45d39a;
  --warn:#ffb84d;
  --low:#4db6ff;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  color:var(--ink);
  background:
    radial-gradient(1200px 700px at 70% -10%, #1a1220 0%, transparent 60%),
    radial-gradient(900px 600px at 10% 0%, #15131f 0%, transparent 65%),
    linear-gradient(#090910,#07070b);
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  overflow-x:hidden;
}

/* fog + pumpkins */
.fog{position:fixed; inset:-10vmax; z-index:0; filter:blur(18px) saturate(1.05); pointer-events:none;
  background:
    radial-gradient(40vmax 20vmax at 20% 30%, rgba(120,120,150,.14), transparent 60%),
    radial-gradient(35vmax 18vmax at 70% 20%, rgba(110,110,140,.09), transparent 60%),
    radial-gradient(50vmax 30vmax at 50% 80%, rgba(120,120,160,.10), transparent 60%);
  animation:fog 80s linear infinite;
}
.fog2{animation-duration:120s; opacity:.6; transform:translateY(-4vh)}
@keyframes fog{to{transform:translateX(6vw)}}

#pumpkins{position:fixed; inset:0; z-index:1; pointer-events:auto}

/* header */
.header{text-align:center; padding:28px 20px 10px; position:relative; z-index:2}
h1{
  margin:0;
  font-family:"UnifrakturMaguntia", cursive;
  font-size:clamp(2.4rem,5vw,4.2rem);
  color:#f4d8e0;
  text-shadow:0 8px 40px #000;
}
.sub{margin:6px 0 10px; color:#c9cbe0; font-size:.95rem}
.bloodbar{
  height:14px;
  margin:8px auto 0;
  max-width:960px;
  border-radius:999px;
  background:
    linear-gradient(90deg,#8b0f23,#d21e3c,#8b0f23) 0/200% 100%;
  border:1px solid #50101b;
  box-shadow:0 8px 30px #000a, inset 0 1px #ff8094;
  position:relative;
  overflow:hidden;
  animation:flow 8s linear infinite;
}
@keyframes flow{to{background-position:200% 0}}

/* main layout */
.wrap{position:relative; z-index:2; max-width:1200px; margin:0 auto; padding:18px 20px 70px}

/* toolbar */
.toolbar{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  justify-content:space-between;
  align-items:center;
  margin:10px 0 14px;
}
.tabs{display:flex; gap:8px; flex-wrap:wrap}
.tab{
  padding:.55rem .9rem;
  border-radius:999px;
  border:1px solid #2a2f44;
  background:#121420;
  color:#d7deff;
  cursor:pointer;
  font-size:.85rem;
}
.tab.active{background:#181b2a; border-color:#343a55}
#search{
  min-width:220px;
  padding:.55rem .8rem;
  border-radius:999px;
  border:1px solid #2a2f44;
  background:#131625;
  color:var(--ink);
  font-size:.9rem;
}
#search:focus{outline:none; border-color:#4a5072; box-shadow:0 0 0 2px #d21e3c33}

/* stats */
.stats{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:14px;
  margin:10px 0 18px;
}
@media (max-width:900px){.stats{grid-template-columns:repeat(2,1fr)}}
@media (max-width:520px){.stats{grid-template-columns:1fr 1fr}}
.card{
  background:linear-gradient(180deg,#0f1119,#0c0e16);
  border:1px solid #1d2132;
  border-radius:16px;
  padding:12px 14px;
  box-shadow:0 12px 30px #0009;
}
.card h3{margin:0; font-size:.78rem; color:#e7dbe1; letter-spacing:.05em}
.num{font-weight:800; font-size:1.6rem; margin-top:5px}
#prodbar{margin-top:6px; height:6px; border-radius:999px; background:#111622; border:1px solid #243045; overflow:hidden}
#prodbar>i{display:block; height:100%; width:0%; background:linear-gradient(90deg,#7e0b22,#d21e3c,#ff6b88); transition:width .6s ease}

/* panels */
.layout{
  display:grid;
  grid-template-columns:3fr 2fr;
  gap:18px;
}
@media (max-width:900px){.layout{grid-template-columns:1fr}}

.panel{
  background:linear-gradient(180deg,#0f1118ee,#0b0d14ee);
  border:1px solid #1f2234;
  border-radius:20px;
  padding:18px 18px 16px;
  box-shadow:0 18px 40px #0009;
}
.panel-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-bottom:10px;
}
.panel-head h4{margin:0; font-size:.95rem; color:#e7dbe1}
.icon-panel{margin-top:18px}

/* list */
.list{display:flex; flex-direction:column; gap:10px}
.task-row{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:12px;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid #24273e;
  background:#101322;
  cursor:pointer;
  transition:background .15s,border-color .15s,transform .12s;
}
.task-row:hover{background:#14182a; border-color:#343a55; transform:translateY(-1px)}
.task-row.done{opacity:.6}
.task-left{display:flex; gap:10px; align-items:flex-start; flex:1 1 auto}
.task-check{margin-top:4px; cursor:pointer}
.task-text{display:flex; flex-direction:column; gap:2px}
.task-title{font-size:.95rem; font-weight:600}
.task-desc{font-size:.8rem; color:var(--muted); max-width:440px; white-space:nowrap; text-overflow:ellipsis; overflow:hidden}
.task-right{
  display:flex;
  gap:6px;
  align-items:center;
  flex-wrap:wrap;
  justify-content:flex-end;
  min-width:180px;
}
.pill{
  padding:3px 8px;
  border-radius:999px;
  border:1px solid #343a5d;
  background:#151827;
  color:#dfe4ff;
  font-size:.75rem;
}
.pill.pri-High{border-color:#7e0b22; background:#190b12; color:#ffd3db}
.pill.pri-Medium{border-color:#7a541a; background:#19140c; color:#ffe3b6}
.pill.pri-Low{border-color:#1c4a34; background:#0e1712; color:#cbffe5}
.pill.overdue{border-color:#7e0b22; background:#190910}
.pill.today{border-color:#ffb84d; background:#1c1408}

.link-btn{
  border:none;
  background:transparent;
  color:#b0b7ff;
  font-size:.78rem;
  cursor:pointer;
  padding:2px 4px;
}
.link-btn:hover{text-decoration:underline}

.empty{
  margin-top:10px;
  padding:10px;
  border-radius:12px;
  border:1px dashed #2a2f44;
  color:#98a2c2;
  font-size:.85rem;
  text-align:center;
}

.mono{
  font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
  color:#aeb6d0;
}

/* form */
.field{display:flex; flex-direction:column; gap:4px; margin-bottom:10px}
.field label{font-size:.85rem; color:#c9cfe6}
input[type="text"],textarea,select,input[type="datetime-local"]{
  padding:10px 11px;
  border-radius:10px;
  border:1px solid #303552;
  background:#141726;
  color:var(--ink);
  font-size:.9rem;
}
textarea{min-height:90px; resize:vertical}
input:focus,textarea:focus,select:focus{outline:none; border-color:#474f7e; box-shadow:0 0 0 2px #d21e3c33}

.grid{display:grid; gap:10px}
.g3{grid-template-columns:1fr 1fr 1fr}
@media (max-width:900px){.g3{grid-template-columns:1fr 1fr}}
@media (max-width:600px){.g3{grid-template-columns:1fr}}

.actions{display:flex; flex-wrap:wrap; gap:8px}
.actions-roomy{margin-top:4px}
.btn{
  border:1px solid #2a2f44;
  background:#121522;
  color:#dfe4ff;
  padding:.7rem .95rem;
  border-radius:12px;
  font-size:.85rem;
  cursor:pointer;
}
.btn:hover{filter:brightness(1.05)}
.btn.primary{
  background:radial-gradient(100% 120% at 0% 0%, var(--blood) 0%, #7e0b22 100%);
  color:#ffebf1;
  border-color:#3a0e18;
  box-shadow:0 16px 34px #d21e3c2a, inset 0 0 0 1px #00000030;
}

/* toast */
.toast{
  position:fixed;
  left:50%;
  bottom:22px;
  transform:translateX(-50%) translateY(8px);
  background:#0f1428ee;
  border:1px solid #2b3055;
  padding:10px 14px;
  border-radius:10px;
  opacity:0;
  pointer-events:none;
  transition:all .2s ease;
  z-index:40;
  font-size:.85rem;
}
.toast.show{opacity:1; transform:translateX(-50%)}

/* card overlay */
.card-overlay{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:50;
}
.card-overlay.hidden{display:none}
.card-backdrop{
  position:absolute;
  inset:0;
  background:rgba(3,3,10,.75);
  backdrop-filter:blur(4px);
}
.card-frame{
  position:relative;
  z-index:1;
  max-width:420px;
  width:90%;
}
.card-shell{perspective:1200px}
.card-front{
  width:100%;
  aspect-ratio:63/88;
  border-radius:22px;
  background:radial-gradient(circle at 20% 0%,#ffecf3 0, #ffb6cf 16%, transparent 40%),
             radial-gradient(circle at 80% 120%, #7e0b22 0, #1a0911 55%);
  border:4px solid #f5d4de;
  padding:10px 12px;
  position:relative;
  box-shadow:0 20px 45px #000a;
  color:#120713;
  transform-style:preserve-3d;
}
.card-shell.flip .card-front{
  animation:flipForward .32s ease;
}
@keyframes flipForward{
  0%{transform:rotateY(0deg)}
  49%{transform:rotateY(90deg)}
  50%{transform:rotateY(-90deg)}
  100%{transform:rotateY(0deg)}
}

/* card content */
.card-top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-family:Inter,system-ui;
  font-weight:700;
  font-size:.95rem;
}
.card-tag{
  font-size:.7rem;
  padding:2px 6px;
  border-radius:999px;
  background:#271020cc;
  color:#ffdce9;
  border:1px solid #f5c5d8;
}
.card-body{
  margin-top:8px;
  background:#fdf5f7bb;
  border-radius:14px;
  padding:8px 9px;
  font-size:.8rem;
  min-height:90px;
  overflow:auto;
}
.card-meta{
  margin-top:8px;
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  font-size:.72rem;
}
.card-meta span{
  padding:3px 7px;
  border-radius:999px;
  background:#2b101cbb;
  color:#ffdbe9;
  border:1px solid #f3c1d8;
}

/* card controls */
.card-close{
  position:absolute;
  top:-8px;
  right:-8px;
  width:28px;
  height:28px;
  border-radius:999px;
  border:none;
  background:#161626;
  color:#f5d4de;
  cursor:pointer;
  box-shadow:0 8px 20px #000a;
}
.card-nav{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  width:28px;
  height:48px;
  border:none;
  border-radius:999px;
  background:#151524ee;
  color:#f8e3f0;
  cursor:pointer;
  font-size:1.1rem;
}
.nav-left{left:-14px}
.nav-right{right:-14px}

/* small screens */
@media (max-width:520px){
  .task-right{min-width:auto; justify-content:flex-start}
  .card-nav{display:none}
}

