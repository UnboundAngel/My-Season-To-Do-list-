/* ===========================
   Project Nexus — styles.css
   One file. No duplicates.
   =========================== */

:root{
  --bg:#0a0912; --bg2:#0f0b18; --vign:#07060b;
  --panel:#11131c; --edge:#232642; --ink:#eceffb; --muted:#a5aec7;
  --crimson:#cf1432; --blood:#7e0b22; --violet:#6a3aa8;
  --good:#2bd28b; --bad:#ff5c7a;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--ink);
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:
    radial-gradient(1200px 800px at 70% -10%, #2a1638 0%, transparent 60%),
    radial-gradient(900px 600px at 10% 0%, #1b142b 0%, transparent 65%),
    radial-gradient(900px 700px at 50% 115%, rgba(210,30,60,.18), transparent 70%),
    linear-gradient(#0a0a12,#090910);
}
body::after{
  content:""; position:fixed; inset:0; pointer-events:none; z-index:-1;
  background:
    radial-gradient(1200px 800px at 50% -10%, transparent 0 60%, rgba(5,4,8,.6) 100%),
    radial-gradient(1000px 600px at 10% 100%, rgba(60,20,80,.15), transparent 60%),
    radial-gradient(900px 600px at 90% 100%, rgba(120,10,30,.18), transparent 60%);
}

/* ---------- Sky (decor only) ---------- */
.sky{position:fixed; inset:0; pointer-events:none; z-index:0}
.blood-moon{
  position:absolute; top:38px; right:36px; width:86px; height:86px; border-radius:50%;
  background:
    radial-gradient(circle at 35% 35%, #ffdca3 0 38%, #ffb84d 40% 62%, #ff8a3a 64% 80%, transparent 82%),
    radial-gradient(80px 80px at 65% 60%, rgba(210,30,60,.45), transparent 60%);
  box-shadow:0 0 42px rgba(210,30,60,.45);
  filter:saturate(1.05);
}
.lanterns{position:absolute; inset:0}
.lantern{width:62px; position:absolute; top:6px; left:8%; transform-origin:top center; animation:sway 6.6s ease-in-out infinite}
.lantern:last-child{left:86%; animation-duration:7.2s}
@keyframes sway{0%{transform:rotate(-6deg)}50%{transform:rotate(6deg)}100%{transform:rotate(-6deg)}}

/* Prevent decoration from stealing clicks */
.sky, .sky *, .blood-moon, .lanterns, .lanterns *, .bloodbar, .bloodbar *{ pointer-events:none }

/* ---------- Header + title drips ---------- */
.top{position:relative; z-index:2; max-width:1100px; margin:88px auto 16px; padding:0 18px}
.nexus{font-family:"UnifrakturMaguntia",cursive; font-size:clamp(2.1rem,5vw,3.2rem); margin:0 0 8px; letter-spacing:.5px; color:#f5e7f9; text-shadow:0 10px 40px #000; position:relative}
.nexus::after{
  content:""; position:absolute; left:18px; right:18px; bottom:-14px; height:8px; border-radius:8px;
  background:linear-gradient(90deg,var(--blood),var(--crimson),var(--blood));
  box-shadow:0 8px 24px rgba(210,30,60,.38), inset 0 1px 0 #ff9ab1;
}
.nexus .drip{position:absolute; top:calc(100% - 8px); width:16px; height:34px; border-radius:8px 8px 14px 14px;
  background:linear-gradient(180deg,var(--crimson) 0%, var(--blood) 85%); filter:drop-shadow(0 8px 12px rgba(0,0,0,.45));
  animation:drip 5.2s cubic-bezier(.2,.8,.2,1) infinite}
.nexus .d1{left:28%}.nexus .d2{left:52%; animation-delay:1.1s}.nexus .d3{left:74%; animation-delay:2.2s}
@keyframes drip{0%{transform:translateY(-10px) scaleY(.4);opacity:0}12%{opacity:1}60%{transform:translateY(36px)}100%{transform:translateY(64px);opacity:0}}

/* ---------- Controls ---------- */
.controls{display:flex; gap:12px; align-items:center; justify-content:space-between}
.tabs{display:flex; gap:8px}
.tab{padding:.55rem 1rem; border-radius:12px; border:1px solid var(--edge); background:#0f1220; color:var(--ink); cursor:pointer; position:relative; overflow:hidden}
.tab.active{outline:2px solid var(--violet)}
.search{min-width:220px; padding:.6rem .8rem; border-radius:12px; border:1px solid var(--edge); background:#0f1220; color:var(--ink)}

/* Reactive crimson halo on .btn/.tab */
.btn,.tab{--mx:50%; --my:50%}
.btn::after,.tab::after{
  content:""; position:absolute; inset:-40px; pointer-events:none; opacity:0; transition:opacity .18s;
  background:radial-gradient(140px circle at var(--mx) var(--my), rgba(207,20,50,.35), transparent 60%);
}
.btn:hover::after,.tab:hover::after{opacity:1}
.btn-aura{
  position:absolute; width:240px; height:240px; margin:-120px 0 0 -120px; border-radius:50%;
  background:radial-gradient(120px 120px at center, rgba(207,20,50,.35), transparent 70%);
  pointer-events:none; mix-blend-mode:screen; transition:transform .06s;
}

/* ---------- Stats ---------- */
.stats{display:grid; grid-template-columns:repeat(4,1fr); gap:14px; margin:18px 0}
.card{position:relative; background:linear-gradient(180deg,#0f1220,#0c0f18); border:1px solid var(--edge); border-radius:14px; padding:14px; overflow:hidden}
.card::after{
  content:""; position:absolute; inset:auto -40px -40px auto; width:160px; height:160px; border-radius:50%;
  background:radial-gradient(circle at 30% 30%, rgba(106,58,168,.35), transparent 60%),
             radial-gradient(circle at 70% 70%, rgba(207,20,50,.22), transparent 60%);
  filter:blur(28px); opacity:.45
}
.card .k{font-size:.78rem; color:var(--muted)}
.card .v{font-weight:800; font-size:1.6rem; margin-top:6px}
#prodbar{margin-top:8px; height:6px; border-radius:999px; background:#0d1220; border:1px solid #22304a; overflow:hidden}
#prodbar>i{display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--violet),var(--crimson)); transition:width .6s}

/* spacing upgrades */
.grid{gap:26px}
.panel{border-radius:18px}
.list{padding:16px}
.task{padding:14px}
.panel-h{padding:16px 18px}
.form{gap:14px; padding:16px}
.actions{gap:10px}
.stats{gap:18px; margin:20px 0}
.card .v{font-size:1.8rem}

/* density presets (root attribute) */
:root[data-density="roomy"] .task{padding:16px}
:root[data-density="compact"] .task{padding:10px; font-size:.95rem}
:root[data-density="compact"] .panel{border-radius:12px}

/* hide stats toggle */
.hide-stats .stats{display:none}

/* Settings modal */
.settings.hide{display:none}
.settings{position:fixed; inset:0; z-index:120; display:flex; align-items:center; justify-content:center;
  background:rgba(8,10,16,.70); backdrop-filter:blur(4px)}
.settings-card{width:min(520px,90vw); background:linear-gradient(180deg,#0f1220,#0b0d16); border:1px solid var(--edge);
  border-radius:16px; box-shadow:0 20px 60px #000c; overflow:hidden}
.settings-head{display:flex; justify-content:space-between; align-items:center; padding:14px 16px; border-bottom:1px solid var(--edge)}
.settings-body{display:grid; gap:14px; padding:16px}
.settings-row{display:flex; justify-content:space-between; align-items:center; gap:12px}
.settings-row label{color:var(--ink)}
.settings select{padding:.55rem .7rem; border-radius:10px; border:1px solid var(--edge); background:#0f1220; color:var(--ink)}

/* Pumpkin strip */
.pumpkin-row{position:fixed; left:0; right:0; bottom:0; height:140px; pointer-events:none; z-index:1;
  background:linear-gradient(180deg, transparent, rgba(20,8,12,.35) 25%, rgba(10,6,9,.8))}
.pumpkin{position:absolute; bottom:16px; width:84px; height:84px; transform-origin:center bottom; animation:bob 4.2s ease-in-out infinite}
@keyframes bob{0%,100%{transform:translateY(0)}50%{transform:translateY(-4px)}}
.pumpkin svg{filter:drop-shadow(0 6px 14px rgba(0,0,0,.6))}
.flame{transform-origin:50% 70%; animation:flicker .9s ease-in-out infinite}
@keyframes flicker{0%,100%{transform:scale(.95) translateY(0); opacity:.9}50%{transform:scale(1.05) translateY(-1px); opacity:.6}}


/* ---------- Layout panels ---------- */
.grid{position:relative; z-index:2; max-width:1100px; margin:0 auto 40px; padding:0 18px; display:grid; grid-template-columns:2fr 1.6fr; gap:18px}
@media (max-width:980px){.grid{grid-template-columns:1fr}}
.panel{background:linear-gradient(180deg,#0f1118ee,#0b0d14ee); border:1px solid var(--edge); border-radius:16px; box-shadow:0 10px 30px #0008; overflow:hidden}
.panel-h{padding:14px 16px; border-bottom:1px solid var(--edge)}
.panel h2{margin:0; font-size:1rem}

/* ---------- Task list ---------- */
.list{padding:12px}
.task{
  --y:0; position:relative; cursor:pointer;
  display:grid; grid-template-columns:1fr auto; gap:10px; align-items:center;
  background:#0e1220; border:1px solid var(--edge); border-radius:12px; padding:12px; margin-bottom:10px;
  animation:pop .18s ease both; transform:translateY(var(--y)); transition:transform .18s, box-shadow .18s, border-color .18s;
}
.task:hover{box-shadow:0 12px 28px #000a; border-color:#2a3354}
@keyframes pop{from{opacity:0; transform:translateY(-8px)} to{opacity:1; transform:none}}
.tTitle{font-weight:700}
.tDesc{font-size:.88rem; color:var(--muted)}
.badges{display:flex; gap:8px; flex-wrap:wrap; margin-top:6px}
.pill{padding:4px 8px; border-radius:999px; border:1px solid #2a3452; background:#0d1326; font-size:.78rem}
.pri-High{border-color:#5f1d1d; background:#1a0f12}
.pri-Medium{border-color:#5f4a1d; background:#1a160f}
.pri-Low{border-color:#174c30; background:#0e1712}
.empty{margin:12px; padding:16px; text-align:center; color:var(--muted); border:1px dashed var(--edge); border-radius:12px}

/* ---------- Buttons + form ---------- */
.actions{display:flex; gap:8px; flex-wrap:wrap}
.btn{border:1px solid var(--edge); background:#101428; color:var(--ink); padding:.6rem .95rem; border-radius:10px; cursor:pointer; position:relative; overflow:hidden}
.btn.primary{background:linear-gradient(90deg,var(--violet) 0%, var(--crimson) 100%); color:#0b0c11; font-weight:700}
.btn.small{padding:.45rem .7rem; font-size:.9rem}
.btn.good{border-color:#1f3a28; background:#0f1a17; color:#c9ffe5}
.btn.bad{border-color:#3f2030; background:#1a1014; color:#ffd5dd}

.form{padding:12px; display:grid; gap:12px}
.form label{display:grid; gap:6px; font-size:.9rem; color:#d5d9ef}
.form input,.form textarea,.form select{padding:.7rem .8rem; border-radius:10px; border:1px solid var(--edge); background:#0f1220; color:var(--ink)}
.form textarea{min-height:110px}
.row{display:flex; gap:10px; flex-wrap:wrap}
.hint{color:var(--muted)}

/* ---------- Deck overlay ---------- */
.deck{
  position:fixed; inset:0; display:none; align-items:center; justify-content:center;
  background:
    radial-gradient(1400px 900px at 70% -10%, rgba(106,58,168,.22), transparent 60%),
    radial-gradient(1200px 800px at 30% 110%, rgba(207,20,50,.18), transparent 70%),
    rgba(8,10,16,.80);
  backdrop-filter:blur(4px); z-index:80;
}
.deckCard{width:min(560px,92vw); height:min(820px,94vh); perspective:1600px; cursor:pointer}
.deckInner{position:relative; width:100%; height:100%; transform-style:preserve-3d; transition:transform .9s cubic-bezier(.2,.7,.15,1)}
.cardFace{
  position:absolute; inset:0; border-radius:18px; border:2px solid #2a3354;
  background:linear-gradient(180deg,#0f1220,#0b0d16); overflow:hidden; backface-visibility:hidden; box-shadow:0 18px 50px #000c;
}
.back{transform:rotateY(180deg)}
.cover{position:absolute; inset:0; background-size:cover; background-position:center; filter:saturate(1.06) contrast(1.02); opacity:.95}
.cover.dim{opacity:.6}
.cardFace .foil{position:absolute; inset:-10%; pointer-events:none; background:
  radial-gradient(40% 60% at 20% 20%, rgba(106,58,168,.35), transparent 60%),
  radial-gradient(40% 60% at 80% 30%, rgba(207,20,50,.28), transparent 60%),
  radial-gradient(60% 60% at 50% 80%, rgba(210,30,60,.22), transparent 60%); mix-blend-mode:screen; filter:blur(14px); opacity:.8}
.cardFace .shine{position:absolute; inset:0; pointer-events:none; background:conic-gradient(from 0deg, transparent 0 40%, rgba(255,255,255,.16) 45%, transparent 60% 100%); opacity:0; transition:opacity .2s}
.cardFace:hover .shine{opacity:.35}
.faceGrid{position:absolute; inset:0; display:grid; grid-template-rows:auto 1fr auto; padding:18px}
.faceHeader{display:flex; justify-content:space-between; align-items:center}
.badge{padding:6px 10px; border-radius:999px; border:1px solid #303a66; background:#0e1630; font-size:.8rem}
.progress{font-size:.9rem; color:#aeb6d0}
.faceBody{font-size:.95rem; color:#e6ebff; display:grid; gap:10px; text-shadow:0 1px 0 #000}
.faceFooter{display:flex; justify-content:space-between; align-items:center}

/* ---------- Card v2 layout pieces ---------- */
.cardGrid{display:grid; grid-template-rows:auto 1fr auto auto; gap:12px; padding:16px}
.pk-top{display:flex; align-items:center; justify-content:space-between; gap:12px}
.pk-title{font-weight:900; letter-spacing:.2px; font-size:1.28rem; margin:0}
.pk-sub{color:#aeb6d0; font-size:.9rem}

/* Progress ring */
.ring{--pct:0; position:relative; width:80px; height:80px; border-radius:50%;
  background:conic-gradient(var(--crimson) var(--pct), #241426 0);
  box-shadow:0 0 28px rgba(207,20,50,.25)}
.ring:before{content:""; position:absolute; inset:10px; border-radius:50%; background:#0d0f1e; box-shadow:inset 0 0 0 1px #2a2f44}
.ring .ringLabel{position:absolute; inset:0; display:grid; place-items:center; font-weight:800; color:#ffd3db; font-size:.82rem}

/* Art window */
.pk-art{position:relative; height:260px; border-radius:14px; overflow:hidden; border:1px solid #2a3354; background:#0d1120}
.pk-art canvas{width:100%; height:100%; display:block}
.foilLayer{position:absolute; inset:-40%; mix-blend-mode:screen; pointer-events:none; opacity:.45;
  background:repeating-conic-gradient(from 0deg, rgba(255,255,255,.06) 0 8deg, transparent 8deg 16deg),
             radial-gradient(80% 120% at 10% 10%, rgba(180,120,255,.14), transparent 60%),
             radial-gradient(80% 120% at 90% 20%, rgba(255,120,80,.14), transparent 60%);
  filter:blur(8px);
}

/* Chips + footer */
.metaRow{display:flex; gap:8px; flex-wrap:wrap}
.chip{padding:6px 10px; border-radius:999px; background:#121628; border:1px solid #2a3354; color:#dfe4ff; font-size:.82rem; white-space:nowrap}
.chip.pri-High{border-color:#7e0b22; background:#180b12; color:#ffd6de}
.chip.pri-Medium{border-color:#7a541a; background:#19140c; color:#ffe3b6}
.chip.pri-Low{border-color:#1c4a34; background:#0e1712; color:#cbffe5}

.footerBar{display:flex; justify-content:space-between; align-items:center; gap:10px; position:sticky; bottom:0; padding-top:6px; background:linear-gradient(180deg, transparent, #0a0c15 40%)}
.footerBar .left,.footerBar .right{display:flex; gap:8px; flex-wrap:wrap}

/* ---------- Toast ---------- */
.toast{position:fixed; left:50%; bottom:18px; transform:translateX(-50%); background:#0e1220; border:1px solid var(--edge); padding:10px 14px; border-radius:10px; opacity:0; pointer-events:none; transition:opacity .15s; z-index:90}
.toast.show{opacity:1}

/* Ensure content floats above bg glows */
.top, .grid, .panel { position:relative; z-index:2 }
/* ===== Project Nexus — Seasonal Themes (data-theme on <html>) ===== */

/* Default if none set = Halloween */
:root[data-theme="halloween"] body{
  background:
    radial-gradient(1200px 800px at 70% -10%, #2a1638 0%, transparent 60%),
    radial-gradient(900px 600px at 10% 0%, #1b142b 0%, transparent 65%),
    radial-gradient(900px 700px at 50% 115%, rgba(210,30,60,.20), transparent 70%),
    linear-gradient(#0a0a12,#090910);
}
:root[data-theme="halloween"]{
  --crimson:#cf1432; --blood:#7e0b22; --violet:#6a3aa8;
  --panel:#11131c; --edge:#232642; --ink:#eceffb; --muted:#a5aec7;
}

/* Autumn: warmer pumpkins + brown edges */
:root[data-theme="autumn"] body{
  background:
    radial-gradient(1200px 800px at 70% -10%, #321a20 0%, transparent 60%),
    radial-gradient(900px 600px at 10% 0%, #221617 0%, transparent 65%),
    radial-gradient(900px 700px at 50% 115%, rgba(255,140,49,.18), transparent 70%),
    linear-gradient(#0b0a0a,#0a0a0a);
}
:root[data-theme="autumn"]{
  --crimson:#d96a2b; --blood:#7a2f14; --violet:#a86a3a;
  --panel:#151013; --edge:#3a2a1d; --ink:#f5efe6; --muted:#c9b7a1;
}

/* Winter: icy blue-violet, higher contrast */
:root[data-theme="winter"] body{
  background:
    radial-gradient(1200px 800px at 70% -10%, #1e2842 0%, transparent 60%),
    radial-gradient(900px 600px at 10% 0%, #141a2b 0%, transparent 65%),
    radial-gradient(900px 700px at 50% 115%, rgba(120,170,255,.18), transparent 70%),
    linear-gradient(#0b0f16,#0a0e14);
}
:root[data-theme="winter"]{
  --crimson:#8bd3ff; --blood:#3a78b8; --violet:#6aa0ff;
  --panel:#0f141e; --edge:#243550; --ink:#eaf4ff; --muted:#a9c0de;
}

/* Spring: mint + blossom accents */
:root[data-theme="spring"] body{
  background:
    radial-gradient(1200px 800px at 70% -10%, #1d2a24 0%, transparent 60%),
    radial-gradient(900px 600px at 10% 0%, #14221b 0%, transparent 65%),
    radial-gradient(900px 700px at 50% 115%, rgba(255,140,200,.16), transparent 70%),
    linear-gradient(#0a1310,#09110e);
}
:root[data-theme="spring"]{
  --crimson:#ff7fb0; --blood:#0f8b6a; --violet:#6ad3b0;
  --panel:#0f1715; --edge:#1e3a32; --ink:#eafff8; --muted:#b6e2d4;
}

/* Summer: deep sunset purples/orange */
:root[data-theme="summer"] body{
  background:
    radial-gradient(1200px 800px at 70% -10%, #3a1d4f 0%, transparent 60%),
    radial-gradient(900px 600px at 10% 0%, #2a173f 0%, transparent 65%),
    radial-gradient(900px 700px at 50% 115%, rgba(255,120,80,.22), transparent 70%),
    linear-gradient(#0e0a14,#0d0a12);
}
:root[data-theme="summer"]{
  --crimson:#ff6a3a; --blood:#b83a1f; --violet:#b26aff;
  --panel:#14101b; --edge:#3a2a55; --ink:#fff1eb; --muted:#e0c5ff;
}

/* Christmas: pine + holly */
:root[data-theme="christmas"] body{
  background:
    radial-gradient(1200px 800px at 70% -10%, #18301d 0%, transparent 60%),
    radial-gradient(900px 600px at 10% 0%, #0f1f13 0%, transparent 65%),
    radial-gradient(900px 700px at 50% 115%, rgba(207,20,50,.20), transparent 70%),
    linear-gradient(#0a120d,#09110d);
}
:root[data-theme="christmas"]{
  --crimson:#cf1432; --blood:#0e7a3c; --violet:#9ad4a6;
  --panel:#0f1512; --edge:#1f3a2a; --ink:#ecfff2; --muted:#b6d9c4;
}

/* ===== Basic themes (no seasonal) ===== */
:root[data-theme="dark-basic"] body{
  background:linear-gradient(#0d0f14,#0b0d12);
}
:root[data-theme="dark-basic"]{
  --panel:#11151e; --edge:#232c44; --ink:#e9ecf6; --muted:#a8b0c6;
  --crimson:#6a88ff; --blood:#475a96; --violet:#6a88ff;
}

:root[data-theme="light-basic"] body{
  background:#f6f7fb;
}
:root[data-theme="light-basic"]{
  --panel:#ffffff; --edge:#d9deea; --ink:#0f1220; --muted:#5b6175;
  --crimson:#cc3366; --blood:#b02a4f; --violet:#4b62d6;
}
